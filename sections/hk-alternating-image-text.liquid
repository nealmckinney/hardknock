{% schema %}
{
  "name": "HK Alternating Image Text",
  "enabled_on": {
    "templates": ["page"]
  },
  "settings": [
    {
      "type": "text",
      "id": "intro_title",
      "label": "Intro Title",
      "default": "Section Title"
    },
    {
      "type": "richtext",
      "id": "intro_text",
      "label": "Intro Text",
      "default": "<p>Add your intro text here</p>"
    },
    {
      "type": "image_picker",
      "id": "intro_image",
      "label": "Intro Image"
    }
  ],
  "blocks": [
    {
      "type": "content",
      "name": "Content Block",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Block Title"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text Content",
          "default": "<p>Add your text content here</p>"
        },
        {
          "type": "image_picker",
          "id": "desktop_image",
          "label": "Desktop Image"
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "Mobile Image (Optional)"
        },
        {
          "type": "checkbox",
          "id": "bleed_image",
          "label": "Bleed Image to Edge",
          "default": false
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "HK Alternating Image Text",
      "blocks": [
        {
          "type": "content"
        }
      ]
    }
  ]
}
{% endschema %}

<div class="page-width bg-white radius-15">
  {% if section.settings.intro_title != blank
    or section.settings.intro_text != blank
    or section.settings.intro_image != blank
  %}
    <div class="flex-container row-wrap flex-clear-1024 v-margin-lg">
      <div class="flex-basis-50 flex-shrink-0 v-pad-lg">
        {% if section.settings.intro_title != blank %}
          <h2 class="h2 mb-md">{{ section.settings.intro_title }}</h2>
        {% endif %}
        {% if section.settings.intro_text != blank %}
          <div class="cms-content">{{ section.settings.intro_text }}</div>
        {% endif %}
      </div>
      {% if section.settings.intro_image != blank %}
        <div class="flex-basis-50 flex-shrink-0">
          <picture>
            <img
              src="{{ section.settings.intro_image | image_url: width: 2000 }}"
              srcset="
                {{ section.settings.intro_image | image_url: width: 1200 }} 1200w,
                {{ section.settings.intro_image | image_url: width: 1600 }} 1600w
              "
              alt="{{ section.settings.intro_image.alt }}"
              class="block"
            >
          </picture>
        </div>
      {% endif %}
    </div>
  {% endif %}

  {% for block in section.blocks %}
    {% if block.type == 'content' %}
      <div class="flex-container row-wrap flex-clear-1024 v-margin-lg" {{ block.shopify_attributes }}>
        <div class="flex-basis-50 flex-shrink-0">
          <div class="relative">
            {% if block.settings.bleed_image %}
              <div class="absolute-bg">
                <picture>
                  {% if block.settings.mobile_image %}
                    <source
                      media="(max-width: 1024px)"
                      srcset="
                        {{ block.settings.mobile_image | image_url: width: 400 }} 400w,
                        {{ block.settings.mobile_image | image_url: width: 600 }} 600w,
                        {{ block.settings.mobile_image | image_url: width: 800 }} 800w,
                        {{ block.settings.mobile_image | image_url: width: 1024 }} 1024w
                      "
                    >
                  {% endif %}
                  <img
                    src="{{ block.settings.desktop_image | image_url: width: 2000 }}"
                    srcset="
                      {{ block.settings.desktop_image | image_url: width: 1200 }} 1200w,
                      {{ block.settings.desktop_image | image_url: width: 1600 }} 1600w
                    "
                    alt="{{ block.settings.title }}"
                    class="object-fit-cover"
                  >
                </picture>
              </div>
            {% else %}
              <picture>
                {% if block.settings.mobile_image %}
                  <source
                    media="(max-width: 1024px)"
                    srcset="
                      {{ block.settings.mobile_image | image_url: width: 400 }} 400w,
                      {{ block.settings.mobile_image | image_url: width: 600 }} 600w,
                      {{ block.settings.mobile_image | image_url: width: 800 }} 800w,
                      {{ block.settings.mobile_image | image_url: width: 1024 }} 1024w
                    "
                  >
                {% endif %}
                <img
                  src="{{ block.settings.desktop_image | image_url: width: 2000 }}"
                  srcset="
                    {{ block.settings.desktop_image | image_url: width: 1200 }} 1200w,
                    {{ block.settings.desktop_image | image_url: width: 1600 }} 1600w
                  "
                  alt="{{ block.settings.title }}"
                  class="block"
                >
              </picture>
            {% endif %}
          </div>
        </div>

        <div class="flex-basis-50 flex-shrink-0 v-pad-lg">
          <h2 class="h2 mb-md">{{ block.settings.title }}</h2>
          <div class="cms-content">{{ block.settings.text }}</div>
        </div>
      </div>
    {% endif %}
  {% endfor %}
</div>
